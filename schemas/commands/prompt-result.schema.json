{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/webuild-ai/claude-toolkit/schemas/prompt-result.json",
  "title": "Prompt Result",
  "description": "Result format for prompt command output - prompt improvement and problem verification",
  "type": "object",
  "properties": {
    "originalPrompt": {
      "type": "string",
      "description": "The original user input"
    },
    "promptAnalysis": {
      "type": "object",
      "properties": {
        "intent": {
          "type": "string",
          "enum": ["feature_request", "bug_fix", "question", "refactoring", "integration", "performance", "security", "testing"],
          "description": "Primary goal identified from the prompt"
        },
        "keyEntities": {
          "type": "object",
          "properties": {
            "features": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "files": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "endpoints": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "models": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        },
        "ambiguities": {
          "type": "array",
          "items": {
            "type": "string",
            "description": "Unclear aspects of the prompt"
          }
        },
        "missingContext": {
          "type": "array",
          "items": {
            "type": "string",
            "description": "Information that should be provided"
          }
        },
        "implicitRequirements": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "requirement": {
                "type": "string"
              },
              "reason": {
                "type": "string"
              }
            },
            "required": ["requirement", "reason"]
          }
        }
      },
      "required": ["intent", "ambiguities"]
    },
    "improvedPrompts": {
      "type": "array",
      "description": "Better versions of the original prompt",
      "items": {
        "type": "object",
        "properties": {
          "version": {
            "type": "string",
            "enum": ["comprehensive", "concise", "detailed_technical"],
            "description": "Type of improved prompt"
          },
          "prompt": {
            "type": "string",
            "description": "The improved prompt text"
          },
          "improvements": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Why this version is better"
          },
          "whenToUse": {
            "type": "string",
            "description": "Scenario when this version is most appropriate"
          }
        },
        "required": ["version", "prompt", "improvements"]
      },
      "minItems": 1
    },
    "problemVerification": {
      "type": "object",
      "properties": {
        "status": {
          "type": "string",
          "enum": ["verified", "partially_verified", "not_found"],
          "description": "Whether the problem actually exists"
        },
        "currentState": {
          "type": "object",
          "properties": {
            "featureExists": {
              "type": "string",
              "enum": ["yes", "no", "partial"]
            },
            "isBroken": {
              "type": "string",
              "enum": ["yes", "no", "unknown", "na"]
            },
            "errorMessages": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "affectedFiles": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        },
        "contextGathered": {
          "type": "object",
          "properties": {
            "sourceFiles": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "path": {
                    "type": "string"
                  },
                  "purpose": {
                    "type": "string"
                  }
                },
                "required": ["path", "purpose"]
              }
            },
            "apiEndpoints": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "method": {
                    "type": "string"
                  },
                  "path": {
                    "type": "string"
                  },
                  "behavior": {
                    "type": "string"
                  }
                }
              }
            },
            "configuration": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "path": {
                    "type": "string"
                  },
                  "purpose": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "problemScope": {
          "type": "object",
          "properties": {
            "affectedComponents": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "userImpact": {
              "type": "string"
            },
            "systemImpact": {
              "type": "string"
            },
            "dataImpact": {
              "type": "string"
            }
          }
        }
      },
      "required": ["status"]
    },
    "solutionPaths": {
      "type": "array",
      "description": "Different approaches to solve the problem",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Name of this solution approach"
          },
          "type": {
            "type": "string",
            "enum": ["quick_fix", "proper_fix", "refactor_first", "incremental", "alternative_approach"],
            "description": "Category of solution"
          },
          "approach": {
            "type": "string",
            "description": "Description of the approach"
          },
          "complexity": {
            "type": "string",
            "enum": ["low", "medium", "high"]
          },
          "pros": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "cons": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "bestFor": {
            "type": "string",
            "description": "When to use this approach"
          },
          "riskLevel": {
            "type": "string",
            "enum": ["low", "medium", "high"]
          },
          "impact": {
            "type": "object",
            "properties": {
              "filesModified": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "breakingChanges": {
                "type": "boolean"
              },
              "dataSchemaChanges": {
                "type": "boolean"
              },
              "apiChanges": {
                "type": "boolean"
              }
            }
          },
          "steps": {
            "type": "array",
            "description": "Actionable implementation steps",
            "items": {
              "type": "object",
              "properties": {
                "stepNumber": {
                  "type": "integer"
                },
                "title": {
                  "type": "string"
                },
                "file": {
                  "type": "string"
                },
                "action": {
                  "type": "string"
                },
                "codeBefore": {
                  "type": "string"
                },
                "codeAfter": {
                  "type": "string"
                },
                "verification": {
                  "type": "string"
                },
                "rollback": {
                  "type": "string"
                }
              },
              "required": ["stepNumber", "title", "action"]
            }
          },
          "testingRequired": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "dependencies": {
            "type": "string",
            "description": "What needs to be done first"
          }
        },
        "required": ["name", "type", "approach", "complexity", "riskLevel", "steps"]
      },
      "minItems": 1
    },
    "solutionComparison": {
      "type": "array",
      "description": "Comparison matrix for solutions",
      "items": {
        "type": "object",
        "properties": {
          "solution": {
            "type": "string"
          },
          "complexity": {
            "type": "string"
          },
          "risk": {
            "type": "string"
          },
          "impact": {
            "type": "string"
          },
          "bestFor": {
            "type": "string"
          }
        },
        "required": ["solution", "complexity", "risk"]
      }
    },
    "recommendedRoadmap": {
      "type": "object",
      "properties": {
        "recommendedPath": {
          "type": "string",
          "description": "Which solution path is recommended"
        },
        "reason": {
          "type": "string",
          "description": "Why this path is recommended"
        },
        "phases": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "phaseName": {
                "type": "string"
              },
              "tasks": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            },
            "required": ["phaseName", "tasks"]
          }
        },
        "milestones": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string"
              },
              "description": {
                "type": "string"
              }
            },
            "required": ["name", "description"]
          }
        },
        "criticalPath": {
          "type": "string",
          "description": "What must be done in sequence"
        },
        "parallelWork": {
          "type": "string",
          "description": "What can be done simultaneously"
        }
      },
      "required": ["recommendedPath", "reason"]
    },
    "nextSteps": {
      "type": "object",
      "properties": {
        "immediateActions": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "commandsToRun": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "command": {
                "type": "string"
              },
              "purpose": {
                "type": "string"
              }
            },
            "required": ["command", "purpose"]
          }
        },
        "filesToReview": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "path": {
                "type": "string"
              },
              "reason": {
                "type": "string"
              }
            },
            "required": ["path", "reason"]
          }
        },
        "questionsToAnswer": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      },
      "required": ["immediateActions"]
    }
  },
  "required": ["originalPrompt", "promptAnalysis", "improvedPrompts", "solutionPaths", "nextSteps"]
}
